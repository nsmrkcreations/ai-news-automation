<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NewSurgeAI - AI-Powered News Platform</title>
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1318338562171737" crossorigin="anonymous"></script>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DX7CWQ62HW"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-DX7CWQ62HW');
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1a1a2e;
            --secondary: #16213e;
            --accent: #0f4c75;
            --highlight: #3282b8;
            --text: #eee;
            --text-secondary: #bbb;
            --bg-dark: #0f0f1e;
            --card-bg: rgba(22, 33, 62, 0.8);
            --breaking: #ff4757;
            --success: #00d2d3;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, var(--primary) 100%);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Header */
        header {
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0,0,0,0.3);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 5%;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--highlight), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            cursor: pointer;
        }

        .header-info {
            display: flex;
            gap: 2rem;
            align-items: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        nav {
            background: var(--secondary);
            padding: 0 5%;
        }

        nav ul {
            list-style: none;
            display: flex;
            gap: 2rem;
            padding: 1rem 0;
            flex-wrap: wrap;
        }

        nav a {
            color: var(--text);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: all 0.3s;
            position: relative;
        }

        nav a:hover, nav a.active {
            background: var(--accent);
            transform: translateY(-2px);
        }

        /* Breaking News Ticker */
        .breaking-news {
            background: var(--breaking);
            padding: 0.8rem 5%;
            overflow: hidden;
            position: relative;
        }

        .breaking-label {
            position: absolute;
            left: 5%;
            background: rgba(0,0,0,0.3);
            padding: 0.3rem 1rem;
            border-radius: 3px;
            font-weight: bold;
            z-index: 1;
        }

        .breaking-content {
            display: flex;
            animation: ticker 30s linear infinite;
            padding-left: 150px;
        }

        @keyframes ticker {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .breaking-item {
            white-space: nowrap;
            padding: 0 3rem;
        }

        /* Search Bar */
        .search-section {
            padding: 1.5rem 5%;
            background: var(--secondary);
        }

        .search-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 1rem;
        }

        .search-section input {
            flex: 1;
            padding: 0.8rem 1rem;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 5px;
            background: rgba(255,255,255,0.1);
            color: var(--text);
            font-size: 1rem;
        }

        .search-section button {
            padding: 0 2rem;
            background: var(--highlight);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .search-section button:hover {
            background: var(--accent);
            transform: translateY(-2px);
        }

        /* Filter Section */
        .filter-section {
            padding: 1rem 5%;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .filter-btn {
            padding: 0.5rem 1.5rem;
            border: 1px solid var(--highlight);
            background: transparent;
            color: var(--text);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .filter-btn:hover, .filter-btn.active {
            background: var(--highlight);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(50, 130, 184, 0.3);
        }

        /* Main Content */
        .main-content {
            padding: 2rem 5%;
        }

        /* Hero Section */
        .hero-section {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .hero-main {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            backdrop-filter: blur(10px);
            transition: transform 0.3s;
        }

        .hero-main:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(50, 130, 184, 0.3);
        }

        .hero-main img {
            width: 100%;
            height: 400px;
            object-fit: cover;
        }

        .hero-content {
            padding: 1.5rem;
        }

        .category-badge {
            display: inline-block;
            background: var(--highlight);
            padding: 0.3rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-bottom: 1rem;
        }

        .hero-sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .sidebar-item {
            background: var(--card-bg);
            padding: 1rem;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
            cursor: pointer;
        }

        .sidebar-item:hover {
            transform: translateX(-5px);
            box-shadow: -5px 5px 20px rgba(50, 130, 184, 0.2);
        }

        /* News Grid */
        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .news-card {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .news-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 15px 40px rgba(50, 130, 184, 0.3);
        }

        .news-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .news-card:hover img {
            transform: scale(1.1);
        }

        .news-card-content {
            padding: 1.5rem;
        }

        .news-card h3 {
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }

        .news-card p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .news-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Load More Button */
        .load-more {
            text-align: center;
            margin: 3rem 0;
        }

        .load-more button {
            background: linear-gradient(135deg, var(--highlight), var(--accent));
            color: white;
            border: none;
            padding: 1rem 3rem;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .load-more button:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(50, 130, 184, 0.4);
        }

        /* Footer */
        footer {
            background: var(--primary);
            padding: 3rem 5%;
            margin-top: 5rem;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-section h3 {
            margin-bottom: 1rem;
            color: var(--highlight);
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-section a:hover {
            color: var(--highlight);
        }

        .newsletter {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .newsletter input {
            flex: 1;
            padding: 0.8rem;
            border: none;
            border-radius: 5px;
            background: rgba(255,255,255,0.1);
            color: var(--text);
        }

        .newsletter button {
            padding: 0.8rem 2rem;
            background: var(--highlight);
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .newsletter button:hover {
            background: var(--accent);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: var(--text-secondary);
        }

        /* Page Content */
        .page-content {
            display: none;
            padding: 2rem 5%;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .page-content.active {
            display: block;
        }

        .page-content h1 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            background: linear-gradient(135deg, var(--highlight), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .page-content h2 {
            color: var(--highlight);
            margin: 2rem 0 1rem;
        }

        .page-content p {
            line-height: 1.8;
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header-info {
                display: none;
            }

            .hero-section {
                grid-template-columns: 1fr;
            }

            .hero-main img {
                height: 250px;
            }

            .news-grid {
                grid-template-columns: 1fr;
            }

            .footer-content {
                grid-template-columns: 1fr;
            }

            nav ul {
                gap: 0.5rem;
            }

            nav a {
                padding: 0.4rem 0.8rem;
                font-size: 0.9rem;
            }
        }

        /* Loading Spinner */
        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }

        .spinner {
            border: 3px solid rgba(255,255,255,0.1);
            border-top: 3px solid var(--highlight);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-top">
            <div class="logo" onclick="showHome()">NewSurgeAI</div>
            <div class="header-info">
                <span id="currentDate"></span>
                <span>AI-Powered News</span>
            </div>
        </div>
        <nav>
            <ul>
                <li><a href="#" class="active" onclick="showHome()">Home</a></li>
                <li><a href="#" onclick="filterCategory('technology')">Technology</a></li>
                <li><a href="#" onclick="filterCategory('business')">Business</a></li>
                <li><a href="#" onclick="filterCategory('science')">Science</a></li>
                <li><a href="#" onclick="filterCategory('world')">World</a></li>
                <li><a href="#" onclick="filterCategory('sports')">Sports</a></li>
                <li><a href="#" onclick="filterCategory('entertainment')">Entertainment</a></li>
                <li><a href="#" onclick="showPage('about')">About</a></li>
                <li><a href="#" onclick="showPage('privacy')">Privacy</a></li>
            </ul>
        </nav>
    </header>

    <!-- Breaking News Ticker -->
    <div class="breaking-news">
        <div class="breaking-label">BREAKING</div>
        <div class="breaking-content" id="breakingNews">
            <span class="breaking-item">Loading latest breaking news...</span>
        </div>
    </div>

    <!-- Search Section -->
    <div class="search-section">
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Search for news, topics, or keywords...">
            <button class="search-btn" onclick="searchNews()">Search</button>
        </div>
    </div>

    <!-- Filter Section -->
    <!-- <div class="filter-section" id="filterSection">
        <button class="filter-btn active" onclick="filterCategory('all')">All News</button>
        <button class="filter-btn" onclick="filterCategory('technology')">Technology</button>
        <button class="filter-btn" onclick="filterCategory('business')">Business</button>
        <button class="filter-btn" onclick="filterCategory('science')">Science</button>
        <button class="filter-btn" onclick="filterCategory('world')">World</button>
        <button class="filter-btn" onclick="filterCategory('sports')">Sports</button>
        <button class="filter-btn" onclick="filterCategory('entertainment')">Entertainment</button>
    </div> -->

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Hero Section -->
        <div class="hero-section" id="heroSection">
            <div class="hero-main">
                <img src="https://via.placeholder.com/800x400/1a1a2e/3282b8?text=Loading+Main+Story" alt="Main Story">
                <div class="hero-content">
                    <span class="category-badge">Technology</span>
                    <h2>Loading main story...</h2>
                    <p>Please wait while we fetch the latest news for you.</p>
                    <div class="news-meta">
                        <span>NewSurgeAI</span>
                        <span>Just now</span>
                    </div>
                </div>
            </div>
            <div class="hero-sidebar" id="heroSidebar">
                <!-- Sidebar items will be populated here -->
            </div>
        </div>

        <!-- News Grid -->
        <h2 style="margin-bottom: 2rem; color: var(--highlight);">Latest News</h2>
        <div class="news-grid" id="newsGrid">
            <!-- News cards will be populated here -->
        </div>

        <!-- Loading Spinner -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p style="margin-top: 1rem;">Loading more news...</p>
        </div>

        <!-- Load More Button -->
        <div class="load-more">
            <button onclick="loadMoreNews()">Load More News</button>
        </div>
    </div>

    <!-- Page Content (About, Privacy, etc.) -->
    <div class="page-content" id="aboutPage">
        <h1>About NewSurgeAI</h1>
        <p>Welcome to NewSurgeAI, your premier destination for AI-powered news aggregation and summarization. We leverage cutting-edge artificial intelligence to bring you the most relevant and important news from around the world.</p>
        
        <h2>Our Mission</h2>
        <p>To democratize access to information by using AI to curate, summarize, and present news in a clear, unbiased, and accessible format. We believe in the power of technology to enhance human understanding and keep people informed about the world around them.</p>
        
        <h2>How It Works</h2>
        <p>Our platform automatically fetches news from multiple trusted sources, uses advanced AI models to summarize and categorize content, and presents it in a beautiful, easy-to-navigate interface. We update our content frequently throughout the day to ensure you never miss important developments.</p>
        
        <h2>Technology Stack</h2>
        <p>We use state-of-the-art language models like Llama for summarization, combined with modern web technologies to deliver a seamless experience across all devices. Our backend runs on powerful local systems to ensure data privacy and security.</p>
        
        <h2>Contact Us</h2>
        <p>Have questions or feedback? We'd love to hear from you! Reach out to us at contact@newsurgeai.com or follow us on social media for updates and announcements.</p>
    </div>

    <div class="page-content" id="privacyPage">
        <h1>Privacy Policy</h1>
        <p>Last updated: 2024</p>
        
        <h2>Information We Collect</h2>
        <p>NewSurgeAI is committed to protecting your privacy. We collect minimal information necessary to provide our services, including:</p>
        <ul style="color: var(--text-secondary); margin-left: 2rem;">
            <li>Anonymous usage statistics to improve our service</li>
            <li>Email addresses for newsletter subscriptions (optional)</li>
            <li>Cookie data for site functionality</li>
        </ul>
        
        <h2>How We Use Your Information</h2>
        <p>We use collected information solely to improve our service, send newsletters (if subscribed), and ensure the platform functions correctly. We never sell or share your personal information with third parties.</p>
        
        <h2>Data Security</h2>
        <p>We implement industry-standard security measures to protect your information. All data transmission is encrypted, and we regularly update our security protocols to maintain the highest level of protection.</p>
        
        <h2>Your Rights</h2>
        <p>You have the right to access, modify, or delete any personal information we have about you. Contact us at privacy@newsurgeai.com to exercise these rights.</p>
        
        <h2>Changes to This Policy</h2>
        <p>We may update this privacy policy from time to time. We will notify you of any changes by posting the new policy on this page and updating the "Last updated" date.</p>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>About NewSurgeAI</h3>
                <p>Your AI-powered news aggregation platform, bringing you the latest news with intelligent summarization.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#" onclick="showHome()">Home</a></li>
                    <li><a href="#" onclick="showPage('about')">About Us</a></li>
                    <li><a href="#" onclick="showPage('privacy')">Privacy Policy</a></li>
                    <li><a href="#">Terms of Service</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Categories</h3>
                <ul>
                    <li><a href="#" onclick="filterCategory('technology')">Technology</a></li>
                    <li><a href="#" onclick="filterCategory('business')">Business</a></li>
                    <li><a href="#" onclick="filterCategory('science')">Science</a></li>
                    <li><a href="#" onclick="filterCategory('world')">World News</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Newsletter</h3>
                <p>Subscribe to get daily news updates</p>
                <div class="newsletter">
                    <input type="email" placeholder="Your email address">
                    <button>Subscribe</button>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 NewSurgeAI. All rights reserved. | Powered by AI</p>
        </div>
    </footer>

    <script>
        let newsData = [];
        let currentCategory = 'all';
        let displayedNews = 6;

        // Function to update date and time
        function updateDateTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            };
            document.getElementById('currentDate').textContent = now.toLocaleString('en-US', options);
        }
        
        // Initialize and update time every second
        updateDateTime();
        setInterval(updateDateTime, 1000);

        // Load news from JSON file
        async function loadNewsData() {
            try {
                // Show loading state
                document.getElementById('loading').style.display = 'block';
                
                // Fetch news from the JSON file
                const response = await fetch('/data/news.json');
                if (!response.ok) {
                    throw new Error('Failed to load news');
                }
                
                const data = await response.json();
                
                // Process the news data to match our format
                newsData = data.map(article => {
                    // Create article object with all necessary fields
                    const processedArticle = {
                        title: article.title || 'No title available',
                        description: article.description || 'No description available',
                        url: article.url || '#',
                        urlToImage: article.urlToImage || 'https://via.placeholder.com/400x250/1a1a2e/3282b8?text=No+Image',
                        publishedAt: article.publishedAt || new Date().toISOString(),
                        source: article.source?.name || 'Unknown Source',
                        isBreaking: Math.random() > 0.7 // Randomly mark some articles as breaking
                    };
                    
                    // Get category based on article content and source
                    processedArticle.category = getCategoryFromSource({
                        ...processedArticle,
                        source: article.source // Pass the full source object
                    });
                    
                    return processedArticle;
                });
                
                // Render the news
                renderNews();
                updateBreakingNews();
                
            } catch (error) {
                console.error('Error loading news:', error);
                // Show error message to user
                const newsGrid = document.getElementById('newsGrid');
                if (newsGrid) {
                    newsGrid.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                            <p>Failed to load news. Please try again later.</p>
                            <button onclick="loadNewsData()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: var(--highlight); color: white; border: none; border-radius: 5px; cursor: pointer;">
                                Retry
                            </button>
                        </div>`;
                }
            } finally {
                // Hide loading state
                document.getElementById('loading').style.display = 'none';
            }
        }
        
        // Helper function to categorize news based on source and content analysis
        function getCategoryFromSource(article) {
            if (!article) return 'general';
            
            const lowerSource = (article.source?.name || '').toLowerCase();
            const lowerTitle = (article.title || '').toLowerCase();
            const lowerDesc = (article.description || '').toLowerCase();
            const content = `${lowerTitle} ${lowerDesc}`;
            
            // Define category keywords with weights
            const categoryKeywords = {
                technology: {
                    keywords: [
                        'tech', 'ai', 'artificial intelligence', 'machine learning', 'software', 'hardware',
                        'computer', 'internet', 'cyber', 'digital', 'startup', 'gadget', 'app', 'smartphone',
                        'blockchain', 'crypto', 'bitcoin', 'ethereum', 'nft', 'metaverse', 'vr', 'ar', 'robot', 'drone'
                    ],
                    sources: ['tech', 'wired', 'the verge', 'engadget', 'cnet', 'gizmodo', 'arstechnica', 'techcrunch']
                },
                business: {
                    keywords: [
                        'business', 'market', 'stock', 'economy', 'investment', 'finance', 'bank', 'company', 'startup',
                        'ceo', 'cfo', 'startup', 'venture', 'funding', 'merger', 'acquisition', 'profit', 'revenue',
                        'economy', 'trading', 'bitcoin', 'crypto', 'currency', 'dollar', 'euro', 'inflation', 'recession'
                    ],
                    sources: ['bloomberg', 'forbes', 'financial times', 'economist', 'wall street', 'marketwatch', 'cnbc', 'reuters business']
                },
                science: {
                    keywords: [
                        'science', 'research', 'study', 'scientist', 'discovery', 'space', 'nasa', 'physics', 'chemistry',
                        'biology', 'medicine', 'health', 'covid', 'vaccine', 'climate', 'environment', 'global warming',
                        'species', 'evolution', 'genetics', 'quantum', 'particle', 'astronomy', 'mars', 'moon', 'black hole'
                    ],
                    sources: ['nature', 'scientific american', 'national geographic', 'new scientist', 'sciencedaily', 'sciencemag', 'space.com', 'nasa']
                },
                world: {
                    keywords: [
                        'world', 'global', 'international', 'europe', 'asia', 'africa', 'middle east', 'united nations',
                        'president', 'prime minister', 'government', 'politics', 'election', 'treaty', 'summit', 'g20',
                        'war', 'conflict', 'peace', 'treaty', 'embassy', 'diplomat', 'refugee', 'immigration', 'border'
                    ],
                    sources: ['bbc', 'reuters', 'associated press', 'ap news', 'al jazeera', 'dw', 'the guardian', 'nytimes', 'washington post', 'cnn']
                },
                sports: {
                    keywords: [
                        'sport', 'football', 'soccer', 'basketball', 'baseball', 'tennis', 'golf', 'olympics', 'championship',
                        'tournament', 'match', 'game', 'player', 'team', 'coach', 'nba', 'nfl', 'mlb', 'nhl', 'fifa', 'uefa',
                        'premier league', 'champions league', 'world cup', 'olympic', 'athlete', 'race', 'score', 'win', 'loss'
                    ],
                    sources: ['espn', 'sport', 'nba', 'nfl', 'mlb', 'nhl', 'fifa', 'uefa', 'pga', 'atp', 'wta', 'skysports', 'bleacher report']
                },
                entertainment: {
                    keywords: [
                        'movie', 'film', 'tv show', 'television', 'netflix', 'disney', 'hbo', 'actor', 'actress', 'director',
                        'oscar', 'emmy', 'grammy', 'music', 'song', 'album', 'artist', 'celebrity', 'hollywood', 'buzzfeed',
                        'gossip', 'award', 'premiere', 'trailer', 'review', 'box office', 'streaming', 'youtube', 'tiktok', 'spotify'
                    ],
                    sources: ['entertainment', 'hollywood', 'variety', 'pitchfork', 'rolling stone', 'billboard', 'mtv', 'eonline', 'tmz']
                }
            };

            // Calculate scores for each category based on content
            const categoryScores = {};
            
            // Check source matches first (higher weight)
            Object.entries(categoryKeywords).forEach(([category, data]) => {
                let score = 0;
                
                // Check source matches
                if (data.sources.some(source => lowerSource.includes(source))) {
                    score += 2; // Higher weight for source match
                }
                
                // Check keyword matches in title and description
                const keywordMatches = data.keywords.filter(keyword => 
                    content.includes(keyword)
                ).length;
                
                // Calculate score based on number of keyword matches
                score += Math.min(keywordMatches * 0.5, 3); // Cap keyword score at 3
                
                categoryScores[category] = score;
            });
            
            // Find category with highest score
            let bestCategory = 'general';
            let highestScore = 0;
            
            for (const [category, score] of Object.entries(categoryScores)) {
                if (score > highestScore) {
                    highestScore = score;
                    bestCategory = category;
                }
            }
            
            // If no strong match found, return a default category based on source
            if (highestScore < 1) {
                if (/tech|gadget|digital|app|software|hardware/.test(lowerSource)) return 'technology';
                if (/busi|money|market|economy|finance/.test(lowerSource)) return 'business';
                if (/sci|nature|environment|health|medical|space/.test(lowerSource)) return 'science';
                if (/sport|game|nba|nfl|mlb|soccer|football|tennis|golf/.test(lowerSource)) return 'sports';
                if (/entertain|movie|music|tv|celebrity|hollywood/.test(lowerSource)) return 'entertainment';
                if (/news|world|politics|nation|global|international/.test(lowerSource)) return 'world';
                
                // If still no match, return a random category (but not too random to avoid UI jumping)
                const defaultCategories = ['technology', 'business', 'science', 'world', 'sports', 'entertainment'];
                const hash = Array.from(lowerSource).reduce((acc, char) => acc + char.charCodeAt(0), 0);
                return defaultCategories[hash % defaultCategories.length];
            }
            
            return bestCategory;
        }

        // Render news
        function renderNews() {
            const newsGrid = document.getElementById('newsGrid');
            const heroSection = document.getElementById('heroSection');
            const heroSidebar = document.getElementById('heroSidebar');
            
            if (!newsData || newsData.length === 0) {
                newsGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                        <p>No news available. Please check back later.</p>
                    </div>`;
                return;
            }
            
            let filteredNews = currentCategory === 'all' 
                ? [...newsData] 
                : newsData.filter(article => article.category === currentCategory);

            // Update hero section with the first breaking news or first article
            const breakingNews = newsData.filter(article => article.isBreaking);
            const mainStory = (breakingNews.length > 0) ? breakingNews[0] : filteredNews[0];
            
            if (mainStory) {
                const heroImg = heroSection.querySelector('.hero-main img');
                const heroTitle = heroSection.querySelector('.hero-main h2');
                const heroDesc = heroSection.querySelector('.hero-main p');
                const heroCategory = heroSection.querySelector('.category-badge');
                const heroMeta = heroSection.querySelector('.news-meta span:first-child');
                const heroDate = heroSection.querySelector('.news-meta span:last-child');
                
                heroImg.src = mainStory.urlToImage;
                heroImg.alt = mainStory.title;
                heroTitle.textContent = mainStory.title;
                heroDesc.textContent = mainStory.description;
                heroCategory.textContent = mainStory.category.toUpperCase();
                heroMeta.textContent = mainStory.source;
                heroDate.textContent = formatDate(mainStory.publishedAt);
                
                // Make hero section clickable
                heroSection.querySelector('.hero-main').onclick = () => {
                    window.open(mainStory.url, '_blank');
                };
            }

            // Update sidebar with next 3 articles (excluding the main story)
            heroSidebar.innerHTML = '';
            const sidebarArticles = filteredNews
                .filter(article => article !== mainStory)
                .slice(0, 3);
                
            sidebarArticles.forEach(article => {
                const sidebarItem = document.createElement('div');
                sidebarItem.className = 'sidebar-item';
                sidebarItem.innerHTML = `
                    <span class="category-badge" style="font-size: 0.7rem; padding: 0.2rem 0.8rem;">
                        ${article.category.toUpperCase()}
                    </span>
                    <h4 style="margin: 0.5rem 0; font-size: 1rem;">${article.title}</h4>
                    <div class="news-meta" style="font-size: 0.75rem;">
                        <span>${article.source}</span>
                        <span>${formatDate(article.publishedAt)}</span>
                    </div>
                `;
                // Make sidebar items clickable
                sidebarItem.style.cursor = 'pointer';
                sidebarItem.onclick = () => window.open(article.url, '_blank');
                heroSidebar.appendChild(sidebarItem);
            });

            // Update news grid
            newsGrid.innerHTML = '';
            const gridArticles = filteredNews
                .filter(article => article !== mainStory && !sidebarArticles.includes(article))
                .slice(0, displayedNews);
                
            if (gridArticles.length === 0) {
                newsGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                        <p>No more news in this category. Try another category or check back later.</p>
                    </div>`;
                return;
            }
            
            gridArticles.forEach(article => {
                const card = createNewsCard(article);
                newsGrid.appendChild(card);
            });
            
            // Show/hide load more button
            const loadMoreBtn = document.querySelector('.load-more');
            if (loadMoreBtn) {
                const remainingArticles = filteredNews.length - gridArticles.length - (mainStory ? 1 : 0) - sidebarArticles.length;
                loadMoreBtn.style.display = remainingArticles > 0 ? 'block' : 'none';
            }
        }

        // Create news card
        function createNewsCard(article) {
            const card = document.createElement('div');
            card.className = 'news-card';
            
            // Truncate description if too long
            const maxLength = 150;
            let description = article.description || '';
            if (description.length > maxLength) {
                description = description.substring(0, maxLength) + '...';
            }
            
            card.innerHTML = `
                <img src="${article.urlToImage}" alt="${article.title}" onerror="this.src='https://via.placeholder.com/400x250/1a1a2e/3282b8?text=No+Image'" loading="lazy">
                <div class="news-card-content">
                    <span class="category-badge" style="font-size: 0.7rem; padding: 0.2rem 0.8rem;">
                        ${article.category.toUpperCase()}
                    </span>
                    <h3>${article.title}</h3>
                    <p>${description}</p>
                    <div class="news-meta">
                        <span>${article.source}</span>
                        <span>${formatDate(article.publishedAt)}</span>
                    </div>
                </div>
            `;
            
            // Make card clickable
            card.style.cursor = 'pointer';
            card.onclick = () => {
                window.open(article.url, '_blank');
            };
            
            return card;
        }

        // Format date
        function formatDate(dateString) {
            if (!dateString) return '';
            
            const date = new Date(dateString);
            if (isNaN(date.getTime())) return ''; // Invalid date
            
            const now = new Date();
            const diff = now - date;
            const seconds = Math.floor(diff / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);
            
            if (seconds < 60) return 'Just now';
            if (minutes < 60) return `${minutes}m ago`;
            if (hours < 24) return `${hours}h ago`;
            if (days === 1) return 'Yesterday';
            if (days < 7) return `${days}d ago`;
            
            // For older dates, show the actual date
            return date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric' 
            });
        }

        // Update breaking news ticker
        function updateBreakingNews() {
            const breakingContent = document.getElementById('breakingNews');
            if (!breakingContent) return;
            
            // If no news data yet, show a default message
            if (!newsData || newsData.length === 0) {
                breakingContent.innerHTML = '<span class="breaking-item">• Loading latest news...</span>';
                return;
            }
            
            // Get up to 5 breaking news items or use the latest 3 if none are marked as breaking
            let breakingNews = newsData.filter(article => article.isBreaking).slice(0, 5);
            
            if (breakingNews.length === 0) {
                // If no articles are marked as breaking, use the most recent 3
                breakingNews = [...newsData].sort((a, b) => 
                    new Date(b.publishedAt) - new Date(a.publishedAt)
                ).slice(0, 3);
            }
            
            if (breakingNews.length > 0) {
                let tickerHTML = '';
                // Duplicate for smooth scrolling effect
                for (let i = 0; i < 2; i++) {
                    breakingNews.forEach(article => {
                        tickerHTML += `
                            <span class="breaking-item" onclick="window.open('${article.url}', '_blank')" 
                                  style="cursor: pointer; white-space: nowrap; margin-right: 2rem;">
                                • ${article.title}
                            </span>`;
                    });
                }
                breakingContent.innerHTML = tickerHTML;
                
                // Initialize ticker animation if not already running
                if (!window.tickerInterval) {
                    startTickerAnimation();
                }
            } else {
                breakingContent.innerHTML = '<span class="breaking-item">• No breaking news at the moment</span>';
            }
        }
        
        // Start the ticker animation
        function startTickerAnimation() {
            const ticker = document.querySelector('.breaking-content');
            if (!ticker) return;
            
            // Reset position
            ticker.style.transform = 'translateX(0)';
            
            // Calculate total width of all items
            const items = ticker.querySelectorAll('.breaking-item');
            if (items.length === 0) return;
            
            // Get the width of the first item (all should be the same)
            const itemWidth = items[0].offsetWidth + 32; // 32px for margin-right
            const totalWidth = itemWidth * (items.length / 2); // Since we duplicate the items
            
            // Animate the ticker
            let position = 0;
            const speed = 40; // pixels per second
            let lastTime = 0;
            
            function animate(currentTime) {
                if (!lastTime) lastTime = currentTime;
                const deltaTime = currentTime - lastTime;
                lastTime = currentTime;
                
                position += (speed * deltaTime) / 1000; // Convert to seconds
                
                // Reset position when we've scrolled one full width
                if (position >= totalWidth) {
                    position = 0;
                }
                
                ticker.style.transform = `translateX(-${position}px)`;
                window.tickerAnimationId = requestAnimationFrame(animate);
            }
            
            // Cancel any existing animation
            if (window.tickerAnimationId) {
                cancelAnimationFrame(window.tickerAnimationId);
            }
            
            // Start the animation
            window.tickerAnimationId = requestAnimationFrame(animate);
        }

        // Filter by category
        function filterCategory(category) {
            currentCategory = category;
            displayedNews = 6; // Reset displayed news count
            
            // Show main content and hide pages
            const mainContent = document.getElementById('mainContent');
            const searchSection = document.querySelector('.search-section');
            const filterSection = document.querySelector('.filter-section');
            
            if (mainContent) mainContent.style.display = 'block';
            if (searchSection) searchSection.style.display = 'block';
            if (filterSection) filterSection.style.display = 'flex';
            
            // Hide all page contents
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.remove('active');
                page.style.display = 'none';
            });
            
            // Update active state for filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.toLowerCase().includes(category) || 
                    (category === 'all' && btn.textContent.toLowerCase().includes('all'))) {
                    btn.classList.add('active');
                }
            });
            
            // Update nav active state
            document.querySelectorAll('nav a').forEach(link => {
                link.classList.remove('active');
                // Activate the category link that was clicked
                if (link.textContent.trim().toLowerCase() === category.toLowerCase()) {
                    link.classList.add('active');
                }
                // Also keep Home active if it's the 'all' category
                if (category === 'all' && link.textContent.trim().toLowerCase() === 'home') {
                    link.classList.add('active');
                }
            });
            
            renderNews();
            // Scroll to top when changing categories
            window.scrollTo(0, 0);
        }

        // Search news
        function searchNews() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            
            // Reset to first page when searching
            displayedNews = 6;
            
            if (!searchTerm) {
                // If search is empty, just re-render with current category
                renderNews();
                return;
            }
            
            // Show loading state
            const newsGrid = document.getElementById('newsGrid');
            const loadingDiv = document.getElementById('loading');
            if (loadingDiv) loadingDiv.style.display = 'block';
            
            // Use setTimeout to allow the UI to update before heavy processing
            setTimeout(() => {
                try {
                    // Filter news based on search term
                    const filteredNews = newsData.filter(article => {
                        // Search in title, description, content, and category
                        const searchText = [
                            article.title || '',
                            article.description || '',
                            article.content || '',
                            article.category || '',
                            article.source || ''
                        ].join(' ').toLowerCase();
                        
                        return searchText.includes(searchTerm);
                    });
                    
                    // Update the news grid with search results
                    if (filteredNews.length === 0) {
                        newsGrid.innerHTML = `
                            <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                                <p>No results found for "${searchTerm}"</p>
                                <button onclick="document.getElementById('searchInput').value = ''; searchNews();" 
                                        style="margin-top: 1rem; padding: 0.5rem 1rem; background: var(--highlight); 
                                               color: white; border: none; border-radius: 5px; cursor: pointer;">
                                    Clear search
                                </button>
                            </div>`;
                    } else {
                        // Create a temporary newsData array with search results
                        const originalNewsData = [...newsData];
                        newsData = filteredNews;
                        
                        // Render the filtered news
                        renderNews();
                        
                        // Restore the original news data
                        newsData = originalNewsData;
                        
                        // Update the URL with the search query
                        const url = new URL(window.location);
                        url.searchParams.set('q', searchTerm);
                        window.history.pushState({}, '', url);
                    }
                } catch (error) {
                    console.error('Error during search:', error);
                    newsGrid.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                            <p>An error occurred during search. Please try again.</p>
                        </div>`;
                } finally {
                    if (loadingDiv) loadingDiv.style.display = 'none';
                }
            }, 100); // Small delay to ensure UI updates
        }

        // Load more news
        function loadMoreNews() {
            const loadMoreBtn = document.querySelector('.load-more button');
            const originalText = loadMoreBtn ? loadMoreBtn.textContent : '';
            
            // Show loading state on button
            if (loadMoreBtn) {
                loadMoreBtn.disabled = true;
                loadMoreBtn.innerHTML = '<div class="small-spinner"></div> Loading...';
                loadMoreBtn.style.opacity = '0.7';
            }
            
            // Simulate loading delay (in a real app, this would be an API call)
            setTimeout(() => {
                displayedNews += 6;
                renderNews();
                
                // Restore button state
                if (loadMoreBtn) {
                    loadMoreBtn.disabled = false;
                    loadMoreBtn.textContent = originalText;
                    loadMoreBtn.style.opacity = '1';
                }
                
                // Smooth scroll to show newly loaded content
                const newsGrid = document.getElementById('newsGrid');
                if (newsGrid) {
                    const newsItems = newsGrid.querySelectorAll('.news-card');
                    if (newsItems.length > 0) {
                        const lastItem = newsItems[newsItems.length - 1];
                        lastItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    }
                }
            }, 500); // Simulate network delay
        }

        // Show home
        function showHome() {
            // Show main content sections
            const mainContent = document.getElementById('mainContent');
            const searchSection = document.querySelector('.search-section');
            const filterSection = document.querySelector('.filter-section');
            
            if (mainContent) mainContent.style.display = 'block';
            if (searchSection) searchSection.style.display = 'block';
            if (filterSection) filterSection.style.display = 'flex';
            
            // Hide all page contents
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.remove('active');
                page.style.display = 'none';
            });
            
            // Update nav
            document.querySelectorAll('nav a').forEach(link => {
                link.classList.remove('active');
            });
            // Activate the Home link
            const homeLink = document.querySelector('nav a[onclick*="showHome"]');
            if (homeLink) homeLink.classList.add('active');
            
            currentCategory = 'all';
            renderNews();
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        // Show page (About, Privacy, etc.)
        function showPage(page) {
            // Hide main content sections
            const mainContent = document.getElementById('mainContent');
            const searchSection = document.querySelector('.search-section');
            const filterSection = document.querySelector('.filter-section');
            
            if (mainContent) mainContent.style.display = 'none';
            if (searchSection) searchSection.style.display = 'none';
            if (filterSection) filterSection.style.display = 'none';
            
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(p => {
                p.classList.remove('active');
                p.style.display = 'none';
            });
            
            // Show selected page
            const targetPage = document.getElementById(page + 'Page');
            if (targetPage) {
                targetPage.classList.add('active');
                targetPage.style.display = 'block';
            }
            
            // Update nav
            document.querySelectorAll('nav a').forEach(link => {
                link.classList.remove('active');
                if ((link.textContent || '').toLowerCase() === page) {
                    link.classList.add('active');
                }
            });
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        // Add search on Enter key and debounce for better performance
        const searchInput = document.getElementById('searchInput');
        if (searchInput) {
            let searchTimeout;
            
            searchInput.addEventListener('keyup', function(e) {
                if (e.key === 'Enter') {
                    searchNews();
                } else {
                    // Debounce the search to avoid too many requests
                    clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(() => {
                        if (this.value.trim().length >= 3 || this.value.trim() === '') {
                            searchNews();
                        }
                    }, 500);
                }
            });
            
            // Clear search when clicking the 'x' in the search input (in some browsers)
            searchInput.addEventListener('search', function() {
                if (this.value === '') {
                    searchNews();
                }
            });
        }

        // Newsletter subscription
        document.querySelector('.newsletter button').addEventListener('click', function() {
            const email = document.querySelector('.newsletter input').value;
            if (email && email.includes('@')) {
                alert('Thank you for subscribing! You will receive our daily news digest.');
                document.querySelector('.newsletter input').value = '';
            } else {
                alert('Please enter a valid email address.');
            }
        });

        // Initialize with sample data for more variety
        function generateMoreSampleData() {
            const categories = ['technology', 'business', 'science', 'world', 'sports', 'entertainment'];
            const sources = ['Tech Weekly', 'Business Today', 'Science Daily', 'World News', 'Sports Central', 'Entertainment Weekly'];
            const sampleTitles = [
                'Artificial Intelligence Revolutionizes Healthcare Industry',
                'Stock Market Reaches All-Time High Amid Economic Recovery',
                'NASA Announces Plans for Mars Colony by 2040',
                'International Peace Summit Brings Hope for Global Conflicts',
                'Championship Finals Draw Record-Breaking Viewership',
                'Award-Winning Director Announces New Blockbuster Project',
                'Quantum Computing Breakthrough Promises Faster Processing',
                'Startup Unicorn Raises $1 Billion in Latest Funding Round',
                'Climate Scientists Warn of Critical Tipping Points',
                'Historic Trade Agreement Signed Between Major Nations',
                'Olympic Games Set to Feature New Exciting Sports',
                'Streaming Service Launches Revolutionary Content Platform'
            ];
            
            // Add more sample news
            for (let i = 0; i < 20; i++) {
                const category = categories[Math.floor(Math.random() * categories.length)];
                const title = sampleTitles[Math.floor(Math.random() * sampleTitles.length)];
                newsData.push({
                    title: title + ' - ' + (i + 7),
                    description: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.',
                    url: '#',
                    urlToImage: `https://via.placeholder.com/400x250/${['1a1a2e', '16213e', '0f4c75'][Math.floor(Math.random() * 3)]}/${['3282b8', '00d2d3'][Math.floor(Math.random() * 2)]}?text=${category.toUpperCase()}`,
                    publishedAt: new Date(Date.now() - Math.random() * 7 * 24 * 60 * 60 * 1000).toISOString(),
                    source: sources[Math.floor(Math.random() * sources.length)],
                    category: category,
                    isBreaking: Math.random() > 0.8
                });
            }
        }

        // Auto-refresh news
        function autoRefreshNews() {
            // Refresh every 15 minutes
            setInterval(() => {
                console.log('Refreshing news...');
                loadNewsData().then(() => {
                    console.log('News refreshed successfully');
                    
                    // Show a subtle notification to the user
                    const notification = document.createElement('div');
                    notification.textContent = 'News updated';
                    notification.style.position = 'fixed';
                    notification.style.bottom = '20px';
                    notification.style.left = '50%';
                    notification.style.transform = 'translateX(-50%)';
                    notification.style.backgroundColor = 'var(--highlight)';
                    notification.style.color = 'white';
                    notification.style.padding = '10px 20px';
                    notification.style.borderRadius = '20px';
                    notification.style.boxShadow = '0 4px 12px rgba(0,0,0,0.2)';
                    notification.style.zIndex = '1000';
                    notification.style.opacity = '0';
                    notification.style.transition = 'opacity 0.3s';
                    
                    document.body.appendChild(notification);
                    
                    // Fade in
                    setTimeout(() => {
                        notification.style.opacity = '1';
                    }, 10);
                    
                    // Fade out and remove after 3 seconds
                    setTimeout(() => {
                        notification.style.opacity = '0';
                        setTimeout(() => {
                            document.body.removeChild(notification);
                        }, 300);
                    }, 3000);
                }).catch(error => {
                    console.error('Error refreshing news:', error);
                });
            }, 15 * 60 * 1000); // 15 minutes
        }

        // PWA Support - Register Service Worker (create sw.js file in production)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // navigator.serviceWorker.register('/sw.js');
                console.log('PWA support ready');
            });
        }

        // Handle offline/online status
        window.addEventListener('online', () => {
            console.log('Back online - refreshing news');
            loadNewsData();
        });

        window.addEventListener('offline', () => {
            console.log('Offline - showing cached content');
        });

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
            });
        });

        // Add animation on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        // Observe news cards for animation
        setTimeout(() => {
            document.querySelectorAll('.news-card').forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'opacity 0.5s, transform 0.5s';
                observer.observe(card);
            });
        }, 100);

        // Initialize
        generateMoreSampleData();
        loadNewsData();
        autoRefreshNews();

    </script>
</body>
</html>